"0","# `data` Formal class genind to be permuted for Fst"
"0","# `nperm` number of Fst permutations"
"0","# `resamples` number of data permutations"
"0",""
"0","perm.fst <- function(data, nperm = 100, resamples = 50){"
"0","  x <- data"
"0","  df <- genind2df(x, sep = ""/"")"
"0",""
"0","  # calculate pairwise fst"
"0","  mat.obs <- genet.dist(x, method = ""WC"") %>% as.matrix()"
"0","  mat.obs <- mat.obs[1,2]"
"0","  cat(""Fst: "", mat.obs, ""\n"")"
"0","  "
"0","  # calculate permute fst"
"0","  nperm <- nperm"
"0","  mat.perm <- sapply(1:nperm, "
"0","                     function(i) {"
"0","    # permute"
"0","    x <- df[sample(1:nrow(df), resamples), ]"
"0","    x <- df2genind(as.matrix(x[,-1]), sep = ""/"", pop = x[,1])"
"0","    "
"0","    # calculate pairwise fst"
"0","    mat.fst <- genet.dist(x, method = ""WC"") %>% as.matrix()"
"0","    mat.fst <- mat.fst[1,2]"
"0","  })"
"0","  "
"0","  # handle as randtest for monte-carlo like simulation of p-values"
"0","  test.rand <- as.randtest("
"0","    sim = na.omit(sapply(1:nperm, "
"0","                         function(i) mat.perm[i])), "
"0","    obs = mat.obs, "
"0","    alter=""greater"" # ((# of permutations >= mat.obs) + 1) / (# of nperm +1)"
"0","    )"
"0","  "
"0","  return(test.rand)"
"0","  "
"0","} # end perm.fst"
"0",""
"0","perm.fst(msats_gen)"
"1","Fst: "
"1"," "
"1","0.002807775"
"1"," "
"1","
"
"1","Monte-Carlo test
"
"1","Call: "
"1","as.randtest(sim = na.omit(sapply(1:nperm, function(i) mat.perm[i])), 
"
"1","    obs = mat.obs, alter = ""greater"")
"
"1","
Observation:"
"1"," "
"1","0.002807775"
"1"," "
"1","
"
"1","
Based on"
"1","Simulated p-value:"
"1"," "
"1","0.4950495"
"1"," "
"1","
"
"1","Alternative hypothesis:"
"1"," "
"1","greater"
"1"," "
"1","

"
"1","      Std.Obs "
"1","  Expectation "
"1","     Variance "
"1","
"
"0","perm.fst(clone_gen)"
"1","Fst: "
"1"," "
"1","0.005438056"
"1"," "
"1","
"
"1","Monte-Carlo test
"
"1","Call: "
"1","as.randtest(sim = na.omit(sapply(1:nperm, function(i) mat.perm[i])), 
"
"1","    obs = mat.obs, alter = ""greater"")
"
"1","0.005438056"
"1"," "
"1","
"
"1","
Based on"
"1"," "
"1","100"
"1"," "
"1","
"
"1","Alternative hypothesis:"
"1"," "
"1","greater"
"1"," "
"1","

"
"1","      Std.Obs "
"1","  Expectation "
"1","     Variance "
"1","
"
"1","-8.468150e-02 "
"1"," 5.784588e-03 "
"1"," 1.674591e-05 "
"1","
"
