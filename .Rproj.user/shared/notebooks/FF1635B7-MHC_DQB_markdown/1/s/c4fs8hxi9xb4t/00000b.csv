"0",""
"0","# plot multiple small heatmaps for single pairs"
"0","sep_heat <- function(x, color = ""blue""){ "
"0","  df <- allele_summaryX[which(allele_summaryX$family == x),]"
"0","  gg <- ggplot( data = df,"
"0","                aes(x = alleles,"
"0","                    y = sample_id, "
"0","                    fill = log(counts+1))) + "
"0","    geom_tile() + "
"0","    coord_fixed(ratio = 0.6) +"
"0","    scale_fill_viridis_c(limits = c(0, 3.5),"
"0","                         begin = 0.05, "
"0","                         breaks = 0:3,"
"0","                         labels = c(0, 2.7, 7.4, 20.1)) +"
"0","    # xlab(""Alleles"") +"
"0","    # ylab(""SSB\n"") +"
"0","    labs(fill = ""Log \nclone \nnumber"") +"
"0","    # theme_minimal() +"
"0","    theme("
"0","      panel.grid = element_blank(),"
"0","      panel.background = element_blank(),"
"0","      axis.text = element_text(color = ""black""),"
"0","      axis.text.x.bottom = element_blank(),"
"0","                                      hjust = 0),"
"0","      axis.title.x = element_blank(),"
"0","      axis.ticks.x = element_blank(),"
"0","      axis.line.y.left = element_line(color = color,"
"0","                                 size = 1),"
"0","      axis.title.y = element_blank(),"
"0","      axis.ticks.y = element_blank(),"
"0","      # axis.text.y  = element_text(color = color_ssb),"
"0","      plot.margin  = unit(c(-.1, 0, 0, 0), ""cm""),"
"0","      legend.position = ""none"""
"0","    )"
"0","  "
"0","  return(gg)"
"0","  "
"0","}"
"0",""
"0","vec <- unique(allele_summaryX$family)"
"0","vec_ssb <- unique(allele_summaryX$family[allele_summaryX$colony == ""SSB""])"
"0","vec_fwb <- unique(allele_summaryX$family[allele_summaryX$colony == ""FWB""])"
"0",""
"0","# create two plot lists for small heatmaps to separate the two colonies"
"0","plots_ssb <- lapply(vec_ssb, sep_heat, color = ""white"")"
"0","plots_fwb <- lapply(vec_fwb, sep_heat, color = ""white"")"
"0",""
"0","# merge in order"
"0","plot_list <- c(plots_ssb, plots_fwb)"
"0",""
"0","# plot heatmap for last individual with x axis"
"0","l <- length(vec)"
"0","plot_list[[l]] <- ggplot("
"0","  data = allele_summaryX[which(allele_summaryX$family == vec[l]),],"
"0","  aes(x = alleles,"
"0","      y = sample_id, "
"0","      fill = log(counts+1))) + "
"0","  geom_tile() + "
"0","  coord_fixed(ratio = 0.6) +"
"0","  scale_fill_viridis_c(name = ""No. of\nclones"","
"0","                       limits = c(0,3.5),"
"0","                       begin = 0.05, "
"0","                       breaks = 0:3,"
"0","                       labels = c(0, 2.7, 7.4, 20.1)) + #log scale"
"0","  ylab(""FWB\n"") +"
"0","  # labs(fill = ""Log \nclone \nnumber"") +"
"0","  # theme_minimal() +"
"0","  theme("
"0","    panel.grid = element_blank(),"
"0","    panel.background = element_blank(),"
"0","    axis.ticks = element_line(color = ""#000000""),"
"0","    axis.text = element_text(color = ""black""),"
"0","    axis.text.y = element_text(size = 10,"
"0","                               hjust = 0), "
"0","    axis.title.y = element_blank(),"
"0","    axis.ticks.y = element_blank(),"
"0","    axis.line.y.left = element_line(color = ""white"", "
"0","                                    size = 1),"
"0","    axis.text.x.bottom = element_text(angle = 45,"
"0","                                      vjust = 1,"
"0","                                      hjust = 1,"
"0","                                      size = 10),"
"0","    axis.title.x = element_text(size = 14),"
"0","    plot.margin = unit(c(-1, 0, 0, 0), ""mm""),"
"0","    legend.position = ""right"","
"0","                                     color = ""black"")"
"0","  )"
"0",""
"0","# increase headspace for first list element"
"0","plot_list[[1]] <- plot_list[[1]] + theme(plot.margin = unit(c(10,0,0,0), ""mm""))"
"0",""
"0","figures[[2]] <- egg::ggarrange(plots = plot_list, ncol = 1)"
