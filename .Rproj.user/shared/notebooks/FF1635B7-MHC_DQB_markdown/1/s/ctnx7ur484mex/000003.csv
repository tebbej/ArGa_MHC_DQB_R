"0",""
"0","# remove putative artefacts from clone info table"
"0","clone_allele_df <- clone_allele_df[1:771,]"
"0",""
"0","# create empty matrix "
"0","# row x col = samples x alleles"
"0","allele_mat <- matrix(nrow = length(unique(clone_allele_df$id)),"
"0","                     ncol = length(unique(clone_allele_df$allele))) %>%"
"0","  `rownames<-`(., as.character(unique(clone_allele_df$id))) %>%"
"0","  `colnames<-`(., as.character("
"0","    str_sort("
"0","      levels("
"0","        clone_allele_df$allele)[1:19], "
"0","      numeric = T)))"
"0",""
"0","# fill matrix with info on which and how many alleles are found "
"0","# in the clones for each individual fur seal"
"0","for (i in seq_along(unique(clone_allele_df$id))) {"
"0","  alleles_in_id <- summary("
"0","    clone_allele_df$allele[clone_allele_df$id == unique("
"0","      clone_allele_df$id)[i]])[1:19]"
"0","  "
"0","  allele_mat[i, ] <- alleles_in_id[str_sort("
"0","    names(alleles_in_id), "
"0","    numeric = T)]"
"0","}"
"0",""
"0","# otu_table handles taxa as rows. This case alleles are ""taxa"" in phylo tree"
"0","allele_mat <- ifelse(allele_mat != 0, 1, 0) %>% "
"0","  t() "
"0",""
"0","# with artefacts, there are 30 allele levels. "
"0","# Make sure, to only keep putative alleles for analysis"
"0","allele_mat <- allele_mat[1:19,]"
"0",""
"0",""
"0","phyloseq_tree <- ape::read.tree(""data/unifrac_tree_p.nwk"")"
"0","# plot tree is interested"
"0","# plot(phyloseq_tree)"
"0",""
"0","# create otu table for phyloseq object"
"0","arga_phylseq <- otu_table(allele_mat, taxa_are_rows = T)"
"0",""
"0","# merge otu table and phyloseq tree"
"0","arga_phylseq <- merge_phyloseq(arga_phylseq, phyloseq_tree)"
"0",""
"0","# create unifrac based on phyloseq"
"0","clone_gen.ufrac <- UniFrac(arga_phylseq, weighted = F) %>% "
"0","  # convert to distance matrix"
"0","  as.matrix()"
"0",""
